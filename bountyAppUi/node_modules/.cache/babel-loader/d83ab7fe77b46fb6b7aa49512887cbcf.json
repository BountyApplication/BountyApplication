{"ast":null,"code":"import * as ZXing from \"../third_party/zxing-js.umd\";\nimport { QrcodeResultFormat, Html5QrcodeSupportedFormats } from \"./core\";\n\nvar ZXingHtml5QrcodeDecoder = function () {\n  function ZXingHtml5QrcodeDecoder(requestedFormats, verbose, logger) {\n    this.formatMap = new Map([[Html5QrcodeSupportedFormats.QR_CODE, ZXing.BarcodeFormat.QR_CODE], [Html5QrcodeSupportedFormats.AZTEC, ZXing.BarcodeFormat.AZTEC], [Html5QrcodeSupportedFormats.CODABAR, ZXing.BarcodeFormat.CODABAR], [Html5QrcodeSupportedFormats.CODE_39, ZXing.BarcodeFormat.CODE_39], [Html5QrcodeSupportedFormats.CODE_93, ZXing.BarcodeFormat.CODE_93], [Html5QrcodeSupportedFormats.CODE_128, ZXing.BarcodeFormat.CODE_128], [Html5QrcodeSupportedFormats.DATA_MATRIX, ZXing.BarcodeFormat.DATA_MATRIX], [Html5QrcodeSupportedFormats.MAXICODE, ZXing.BarcodeFormat.MAXICODE], [Html5QrcodeSupportedFormats.ITF, ZXing.BarcodeFormat.ITF], [Html5QrcodeSupportedFormats.EAN_13, ZXing.BarcodeFormat.EAN_13], [Html5QrcodeSupportedFormats.EAN_8, ZXing.BarcodeFormat.EAN_8], [Html5QrcodeSupportedFormats.PDF_417, ZXing.BarcodeFormat.PDF_417], [Html5QrcodeSupportedFormats.RSS_14, ZXing.BarcodeFormat.RSS_14], [Html5QrcodeSupportedFormats.RSS_EXPANDED, ZXing.BarcodeFormat.RSS_EXPANDED], [Html5QrcodeSupportedFormats.UPC_A, ZXing.BarcodeFormat.UPC_A], [Html5QrcodeSupportedFormats.UPC_E, ZXing.BarcodeFormat.UPC_E], [Html5QrcodeSupportedFormats.UPC_EAN_EXTENSION, ZXing.BarcodeFormat.UPC_EAN_EXTENSION]]);\n    this.reverseFormatMap = this.createReverseFormatMap();\n\n    if (!ZXing) {\n      throw \"Use html5qrcode.min.js without edit, ZXing not found.\";\n    }\n\n    this.verbose = verbose;\n    this.logger = logger;\n    var formats = this.createZXingFormats(requestedFormats);\n    var hints = new Map();\n    hints.set(ZXing.DecodeHintType.POSSIBLE_FORMATS, formats);\n    this.hints = hints;\n  }\n\n  ZXingHtml5QrcodeDecoder.prototype.decodeAsync = function (canvas) {\n    var _this = this;\n\n    return new Promise(function (resolve, reject) {\n      try {\n        resolve(_this.decode(canvas));\n      } catch (error) {\n        reject(error);\n      }\n    });\n  };\n\n  ZXingHtml5QrcodeDecoder.prototype.decode = function (canvas) {\n    var zxingDecoder = new ZXing.MultiFormatReader(this.verbose, this.hints);\n    var luminanceSource = new ZXing.HTMLCanvasElementLuminanceSource(canvas);\n    var binaryBitmap = new ZXing.BinaryBitmap(new ZXing.HybridBinarizer(luminanceSource));\n    var result = zxingDecoder.decode(binaryBitmap);\n    return {\n      text: result.text,\n      format: QrcodeResultFormat.create(this.toHtml5QrcodeSupportedFormats(result.format))\n    };\n  };\n\n  ZXingHtml5QrcodeDecoder.prototype.createReverseFormatMap = function () {\n    var result = new Map();\n    this.formatMap.forEach(function (value, key, _) {\n      result.set(value, key);\n    });\n    return result;\n  };\n\n  ZXingHtml5QrcodeDecoder.prototype.toHtml5QrcodeSupportedFormats = function (zxingFormat) {\n    if (!this.reverseFormatMap.has(zxingFormat)) {\n      throw \"reverseFormatMap doesn't have \" + zxingFormat;\n    }\n\n    return this.reverseFormatMap.get(zxingFormat);\n  };\n\n  ZXingHtml5QrcodeDecoder.prototype.createZXingFormats = function (requestedFormats) {\n    var zxingFormats = [];\n\n    for (var _i = 0, requestedFormats_1 = requestedFormats; _i < requestedFormats_1.length; _i++) {\n      var requestedFormat = requestedFormats_1[_i];\n\n      if (this.formatMap.has(requestedFormat)) {\n        zxingFormats.push(this.formatMap.get(requestedFormat));\n      } else {\n        this.logger.logError(requestedFormat + \" is not supported by\" + \"ZXingHtml5QrcodeShim\");\n      }\n    }\n\n    return zxingFormats;\n  };\n\n  return ZXingHtml5QrcodeDecoder;\n}();\n\nexport { ZXingHtml5QrcodeDecoder };","map":{"version":3,"mappings":"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","names":["ZXing","QrcodeResultFormat","Html5QrcodeSupportedFormats","requestedFormats","verbose","logger","Map","QR_CODE","BarcodeFormat","AZTEC","CODABAR","CODE_39","CODE_93","CODE_128","DATA_MATRIX","MAXICODE","ITF","EAN_13","EAN_8","PDF_417","RSS_14","RSS_EXPANDED","UPC_A","UPC_E","UPC_EAN_EXTENSION","createReverseFormatMap","formats","createZXingFormats","hints","set","DecodeHintType","POSSIBLE_FORMATS","ZXingHtml5QrcodeDecoder","canvas","Promise","resolve","reject","_this","decode","error","zxingDecoder","MultiFormatReader","luminanceSource","HTMLCanvasElementLuminanceSource","binaryBitmap","BinaryBitmap","HybridBinarizer","result","text","format","create","toHtml5QrcodeSupportedFormats","formatMap","forEach","value","key","_","zxingFormat","reverseFormatMap","has","get","zxingFormats","_i","requestedFormat","push","logError"],"sources":["../../src/zxing-html5-qrcode-decoder.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}